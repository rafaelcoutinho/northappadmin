<div class="content-wrapper">
    <div class="container">

        <section class="content-header">
            <h1>
         {{etapa.titulo}}
          <small> {{etapa.data|date:'dd-MM-yyyy'}}</small>
        </h1>

        </section>


        <section class="content" ng-hide="etapaFinalizada">

            <div class="box box-default">
                <div class="box-header with-border">
                    <h3 class="box-title">Inscrição</h3>
                </div>
                <div class="box-body">
                    Inscreva sua equipe para a próxima etapa da CopaNorth. Para isso, se identifique, selecione sua equipe e seus integrantes.

                </div>

            </div>
            <div class="box box-default">
                <div class="box-header with-border">
                    <h3 class="box-title text-green" ng-show="showForm==false && competidor.id!=null
                                            "><i class="fa fa-check"  ></i> {{competidor.nome}}</h3>
                    <h3 ng-hide="showForm==false && competidor.id!=null
                                            ">Competidor </h3>
                    <div class="pull-right box-tools">
                        <button class="btn btn-warning btn-xs" ng-show="showForm==false && competidor.id!=null
                                            " ng-cloak ng-click="showForm=true;competidor={} ">Alterar</button>
                    </div>

                </div>
                <div class="box-body" ng-show="competidor.id==null || showForm">
                    <div>
                        <a class="btn btn-block btn-social btn-facebook" ng-click="connectFB()">
                            <i class="fa fa-facebook"></i> {{fbmsg}}
                        </a>
                        <!--<a class="btn btn-block btn-social btn-google">
                            <i class="fa fa-google-plus"></i> Conectar com Google
                        </a>-->
                        <p class="text-muted" style="text-align:center;" ng-click="showForm = !showForm">Ou use formulário</p>
                        <div ng-show="showForm" ng-cloak>
                            <form name="form" class="css-form" novalidate>
                                <div class="form-group">
                                    <label for="inputTrekker" class="col-sm-2 control-label">*Nome</label>
                                    <div class="col-sm-10">
                                        <input type="text" ng-blur="exitFilterCompetidor()" ng-model="novoCompetidor" id="inputTrekker" placeholder="Nome " typeahead-show-hint="true"
                                        uib-typeahead="g as g.nome for g in competidores | filter:{nome:$viewValue} |
                                    limitTo:8 " typeahead-editable="true " class="form-control " typeahead-select-on-exact="true"
                                        typeahead-template-url="customTemplate.html" typeahead-min-length="2" typeahead-no-results="noResult">
                                    </div>
                                </div>

                                <div class="form-group " ng-show="noResult">
                                    <label for="inputEmail " class="col-sm-2 control-label ">*E-mail</label>
                                    <div class="col-sm-10 ">
                                        <input type="email" ng-model-options="{ updateOn: 'blur' }" required ng-model="novoCompetidor.email " name="competidorEmail"
                                        id="inputEmail" " placeholder="xxx@xxx.xxx " class="form-control ">
                                    <span class="text-red "  ng-show="form.competidorEmail.$error.email ">Formato inválido de email</span>
                                    <span class="text-red "  ng-show="form.competidorEmail.$error.required ">E-mail é obrigatório</span>
                                </div>
                                 
                            </div>
                            <div class="form-group " ng-show="noResult ">
                                <label for="inputtelefone " class="col-sm-2 control-label ">Telefone</label>
                                <div class="col-sm-10 ">
                                    <input type="tel " ng-model="novoCompetidor.telefone " id="inputtelefone
                                        "  placeholder="(XX) XXXXX-XXXX "
                                            class="form-control ">
                                        </div>
                                    </div>

                                </form>
                            </div>
                        </div>
                    </div>
                    <div class="box-footer " ng-show="showForm " >
                        <p class="text-red " style="text-align:center; " ng-click="errorMsg ">{{errorMsg}}</p>
                        <button type="submit " class="btn btn-primary " ng-cloak ng-click="saveCompetidor() ">Salvar</button>
                        
                    </div>

                </div>

                <div class="box box-default " ng-show="competidor.id ">
                    <div class="box-header with-border ">
                         <h3 class="box-title text-green " ng-hide="showFormEquipe==true || competidor.id_Equipe==null ">
                             <i class="fa fa-check "  ></i> {{competidor.equipe}}
                             </h3> 
                             <h3 ng-show="showFormEquipe==true || competidor.id_Equipe==null ">Equipe</h3>                        
                        <div class="pull-right box-tools ">
                            <button class="btn btn-warning btn-xs "  ng-hide="showFormEquipe==true || competidor.id_Equipe==null
                                        " ng-click="showFormEquipe=true ">Alterar</button>
                        </div>
                    </div>
                    <div class="box-body " ng-show="competidor.id_Equipe==null || showFormEquipe " ng-cloak>


                        
                            <form name="form " class="css-form " novalidate>
                                <div class="form-group ">
                                    <label for="inputTrekker " class="col-sm-2 control-label ">*Nome</label>
                                    <div class="col-sm-10 ">
                                        <input type="text " ng-blur="exitFilterEquipe() " ng-model="novaEquipe " id="inputEquipe
                                        " placeholder="Nome Equipe " typeahead-show-hint="true " autocomplete="off " 
                                        uib-typeahead="g as g.nome for g in equipes | filter:{nome:$viewValue} | limitTo:8
                                        " typeahead-editable="true " class="form-control " typeahead-select-on-exact="true "
                                        typeahead-template-url="customTemplateEquipe.html " typeahead-min-length="1
                                        " typeahead-no-results="noResultEquipe ">
                                    </div>
                                </div>

                                
                                 
                            <small  ng-show="noResultEquipe ">Criar nova equipe</small>
                            <div class="form-group " ng-show="noResultEquipe ">
                                <label for="inputCidade " class="col-sm-2 control-label ">Cidade</label>
                                <div class="col-sm-10 ">
                                    <input type="tel " ng-model="novaEquipe.descricao " id="inputCidade " class="form-control ">
                                </div>
                            </div>

                         <div class="col-sm-10 " ng-show="noResultEquipe ">
                                <select class="form-control " ng-model="novaEquipe.id_Categoria " ng-disabled="novaEquipe.id!=null
                                        " placeholder="Selecione a categoria ">
                                    <option ng-repeat="categoria in categorias " value="{{categoria.id}} ">{{categoria.nome}}</option>
                                </select>
                            </div>
                            <small  ng-show="noResultEquipe " class="text-muted "> (*Para alterar uma equipe existente utilize o aplicativo da North)</small>
                            
                            </form>
                            

                    </div>
                    <div class="box-footer "  ng-show="showFormEquipe==true || competidor.id_Equipe==null ">
                        <p class="text-red " style="text-align:center; " ng-click="errorMsg ">{{errorMsgEquipe}}</p>
                        <button type="submit " class="btn btn-primary " ng-cloak ng-click="saveEquipe() ">Salvar</button>
                        
                    </div>

                </div>
                
                 <div class="box box-default " ng-show="competidor.id && competidor.id_Equipe "  ng-cloak>
                    <div class="box-header with-border "><h3>Inscrição</h3>
                    </div>
                    <div class="box-body " >
                        Clique em inscrever abaixo para se inscrever na etapa.                        

                    </div>
                    <div class="box-footer " >
                        
                        <button type="submit " class="btn btn-primary " ng-cloak ng-click="inscrever() ">Inscrever</button>
                        
                    </div>

                </div>

            </section>
            
        </div>
        
    </div>
    
    
   
    <script type="text/ng-template " id="customTemplate.html ">
        <a>
            
            <span ng-bind-html="match.model.nome + ' - '+ (match.model.equipe!=null?match.model.equipe: 'Sem Equipe') |
                                        uibTypeaheadHighlight:query "></span>
        </a>
    </script>
    <script type="text/ng-template " id="customTemplateEquipe.html ">
        <a>
            
            <span ng-bind-html="match.model.nome + ' - '+ (match.model.descricao) | uibTypeaheadHighlight:query "></span>
        </a>
    </script>